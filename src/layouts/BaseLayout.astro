---
import '../styles/global.css';
import ThemeScript from '../components/common/ThemeScript.astro';
import Header from '../components/layout/Header.astro';
import Footer from '../components/layout/Footer.astro';
import SEO from '../components/common/SEO.astro';
import CopyCodeScript from '../components/common/CopyCodeScript.astro';
import Analytics from '../components/common/Analytics.astro';
import { SITE_CONFIG } from '@/lib/constants/site';

export interface Props {
  title?: string;
  description?: string | undefined;
  image?: string | undefined;
  type?: 'website' | 'article';
}

const {
  title = SITE_CONFIG.title,
  description = SITE_CONFIG.description,
  image,
  type = 'website',
} = Astro.props;

const pageTitle = title === SITE_CONFIG.title ? title : `${title} | ${SITE_CONFIG.title}`;
---

<!doctype html>
<html lang="ko" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />

    <ThemeScript />

    <SEO title={pageTitle} description={description} image={image} type={type} />
    <Analytics />

    <link rel="preconnect" href="https://www.notion.so" />
    <link rel="preconnect" href="https://img.notionusercontent.com" crossorigin />

    <link
      rel="preload"
      href="/fonts/Pretendard-Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="/fonts/Pretendard-Bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="/fonts/JetBrainsMono-Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="/fonts/JetBrainsMono-Bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <style>
      @font-face {
        font-family: 'Pretendard';
        font-style: normal;
        font-weight: 400;
        font-display: optional;
        src: url('/fonts/Pretendard-Regular.woff2') format('woff2');
        size-adjust: 100%;
      }
      @font-face {
        font-family: 'Pretendard';
        font-style: normal;
        font-weight: 700;
        font-display: optional;
        src: url('/fonts/Pretendard-Bold.woff2') format('woff2');
        size-adjust: 100%;
      }
      @font-face {
        font-family: 'JetBrains Mono';
        font-style: normal;
        font-weight: 400;
        font-display: optional;
        src: url('/fonts/JetBrainsMono-Regular.woff2') format('woff2');
      }
      @font-face {
        font-family: 'JetBrains Mono';
        font-style: normal;
        font-weight: 700;
        font-display: optional;
        src: url('/fonts/JetBrainsMono-Bold.woff2') format('woff2');
      }

      html {
        font-family: 'Pretendard', 'Apple SD Gothic Neo', 'Malgun Gothic', system-ui, sans-serif;
        font-weight: 400;
      }
      * {
        font-synthesis: none;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }
      body {
        font-weight: 400;
      }
      strong,
      b,
      .font-bold,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: 700;
      }
    </style>
  </head>
  <body>
    <div
      class="flex min-h-screen flex-col bg-white text-gray-900 dark:bg-gray-950 dark:text-gray-100"
    >
      <Header />
      <main class="container mx-auto flex-1 px-4 py-8 sm:px-6 lg:px-8">
        <slot />
      </main>
      <Footer />
    </div>
    <CopyCodeScript />

    <script>
      import { theme } from '@/lib/theme';
      theme.init();
      window.addEventListener('DOMContentLoaded', () => {
        theme.reinit();
      });
    </script>
  </body>
</html>
