---
// 테마 스크립트 - FOUC 방지 및 상태 유지
---

<script is:inline>
  // 즉시 실행 함수로 초기 테마 적용
  (function () {
    const getTheme = () => {
      const stored = localStorage.getItem('theme');
      if (stored === 'light' || stored === 'dark') {
        return stored;
      }
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };

    const applyTheme = (theme) => {
      const root = document.documentElement;
      if (theme === 'dark') {
        root.classList.add('dark');
      } else {
        root.classList.remove('dark');
      }
    };

    // 초기 테마 적용
    const theme = getTheme();
    applyTheme(theme);

    // 전역 객체에 테마 관련 함수 노출 (View Transitions 용)
    window.__theme = {
      current: theme,
      apply: applyTheme,
      get: getTheme,
    };
  })();
</script>
